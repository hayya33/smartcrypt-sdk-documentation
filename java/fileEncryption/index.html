<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Smartcrypt SDK for Java"><link href=https://sdk.smartcrypt.com/java/fileEncryption/ rel=canonical><meta name=author content="PKWARE, Inc."><link rel="shortcut icon" href=../images/smartcrypt.svg><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.3.2"><title>Overview - Smartcrypt Java SDK</title><link rel=stylesheet href=../assets/stylesheets/main.fe0cca5b.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../css/app.css></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#file-encryption class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://sdk.smartcrypt.com/java title="Smartcrypt Java SDK" class="md-header-nav__button md-logo" aria-label="Smartcrypt Java SDK"> <img src=../images/smartcrypt.svg alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Smartcrypt Java SDK </span> <span class="md-header-nav__topic md-ellipsis"> Overview </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../concepts/logging/ class=md-tabs__link> General concepts </a> </li> <li class=md-tabs__item> <a href=./ class="md-tabs__link md-tabs__link--active"> File encryption </a> </li> <li class=md-tabs__item> <a href=../keyManagement/ class=md-tabs__link> Key management </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://sdk.smartcrypt.com/java title="Smartcrypt Java SDK" class="md-nav__button md-logo" aria-label="Smartcrypt Java SDK"> <img src=../images/smartcrypt.svg alt=logo> </a> Smartcrypt Java SDK </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Overview class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> General concepts <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="General concepts" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> General concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../concepts/logging/ title=Logging class=md-nav__link> Logging </a> </li> <li class=md-nav__item> <a href=../concepts/flpe/ title="Format and length preserving encryption" class=md-nav__link> Format and length preserving encryption </a> </li> <li class=md-nav__item> <a href=../concepts/notifications/ title=Notifications class=md-nav__link> Notifications </a> </li> <li class=md-nav__item> <a href=../concepts/observables/ title=Observables class=md-nav__link> Observables </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../faq/ title=FAQ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ title=Troubleshooting class=md-nav__link> Troubleshooting </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5 checked> <label class=md-nav__link for=nav-5> File encryption <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="File encryption" data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> File encryption </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Overview <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title=Overview class="md-nav__link md-nav__link--active"> Overview </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#setup class=md-nav__link> Setup </a> </li> <li class=md-nav__item> <a href=#create-a-zip class=md-nav__link> Create a ZIP </a> <nav class=md-nav aria-label="Create a ZIP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuring-encryption class=md-nav__link> Configuring encryption </a> </li> <li class=md-nav__item> <a href=#configuring-compression class=md-nav__link> Configuring compression </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#encryption class=md-nav__link> Encryption </a> <nav class=md-nav aria-label=Encryption> <ul class=md-nav__list> <li class=md-nav__item> <a href=#contingency-group-without-smartkey class=md-nav__link> Contingency group without Smartkey </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decryption class=md-nav__link> Decryption </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=installing/ title=Installing class=md-nav__link> Installing </a> </li> <li class=md-nav__item> <a href=zipDetails/ title="Zip file details" class=md-nav__link> Zip file details </a> </li> <li class=md-nav__item> <a href=../api/index.html?com/pkware/smartcrypt/unstructured/package-summary.html title="API docs" class=md-nav__link> API docs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Key management <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Key management" data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Key management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../keyManagement/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../keyManagement/installing/ title=Installing class=md-nav__link> Installing </a> </li> <li class=md-nav__item> <a href=../keyManagement/keySegregation/ title="Key segregation" class=md-nav__link> Key segregation </a> </li> <li class=md-nav__item> <a href=../keyManagement/metaClient/ title=MetaClient class=md-nav__link> MetaClient </a> </li> <li class=md-nav__item> <a href=../api/index.html?com/pkware/smartcrypt/keymanagement/package-summary.html title="API docs" class=md-nav__link> API docs </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../changelog/ title="Change log" class=md-nav__link> Change log </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#setup class=md-nav__link> Setup </a> </li> <li class=md-nav__item> <a href=#create-a-zip class=md-nav__link> Create a ZIP </a> <nav class=md-nav aria-label="Create a ZIP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuring-encryption class=md-nav__link> Configuring encryption </a> </li> <li class=md-nav__item> <a href=#configuring-compression class=md-nav__link> Configuring compression </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#encryption class=md-nav__link> Encryption </a> <nav class=md-nav aria-label=Encryption> <ul class=md-nav__list> <li class=md-nav__item> <a href=#contingency-group-without-smartkey class=md-nav__link> Contingency group without Smartkey </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decryption class=md-nav__link> Decryption </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=file-encryption>File encryption<a class=headerlink href=#file-encryption title="Permanent link">&para;</a></h1> <p>The file encryption component uses ZIP files to protect sensitive data. ZIP files are an ideal format, as a lot of software are aware of the format and work well with it. ZIPs also come with a range of desireable properties:</p> <ul> <li>Easy-to-use compression of data <em>prior to encryption</em>.</li> <li>Support for encrypting an entire folder hierarchy, thereby keeping related files together and allowing them to be easily shared.</li> <li>File name encryption, thereby protecting potentially sensitive document file names.</li> <li>Embedded support for Smartkeys, including Community keys and Contingency Groups.</li> </ul> <h2 id=setup>Setup<a class=headerlink href=#setup title="Permanent link">&para;</a></h2> <p>To get started, you&rsquo;ll need to create a new instance of <a href=/api/index.html?com/pkware/smartcrypt/unstructured/UnstructuredData.html><code>UnstructuredData</code></a>. See the <a href=/keyManagement/metaClient>MetaClient</a> docs for details on how to obtain the <code>MetaClient</code> instance.</p> <div class=tabbed-set data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClient</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredDataImpl</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=n>UnstructuredData</span> <span class=nf>setUp</span><span class=p>(</span><span class=n>MetaClient</span> <span class=n>metaClient</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>return</span> <span class=k>new</span> <span class=n>UnstructuredDataImpl</span><span class=p>.</span><span class=na>Builder</span><span class=p>()</span>
    <span class=p>.</span><span class=na>metaClient</span><span class=p>(</span><span class=n>metaClient</span><span class=p>)</span>
    <span class=p>.</span><span class=na>license</span><span class=p>(</span><span class=s>&quot;&lt;Your license here&gt;&quot;</span><span class=p>)</span>
    <span class=p>.</span><span class=na>build</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClient</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredDataImpl</span>

<span class=k>fun</span> <span class=nf>setUp</span><span class=p>(</span><span class=n>metaClient</span><span class=p>:</span> <span class=n>MetaClient</span><span class=p>):</span> <span class=n>UnstructuredData</span> <span class=p>=</span>
  <span class=n>UnstructuredDataImpl</span><span class=p>.</span><span class=n>Builder</span><span class=p>()</span>
    <span class=p>.</span><span class=n>metaClient</span><span class=p>(</span><span class=n>metaClient</span><span class=p>)</span>
    <span class=p>.</span><span class=n>license</span><span class=p>(</span><span class=s>&quot;&lt;Your license here&gt;&quot;</span><span class=p>)</span>
    <span class=p>.</span><span class=n>build</span><span class=p>()</span>
</code></pre></div> </div> </div> <p>Instances of <code>UnstructuredData</code> are thread safe and should be reused throughout your application.</p> <h2 id=create-a-zip>Create a ZIP<a class=headerlink href=#create-a-zip title="Permanent link">&para;</a></h2> <p>The basic steps of creating a ZIP are the same regardless of which encryption parameters are used.</p> <div class=tabbed-set data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveEntry</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutputFile</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.InputStream</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Map</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>createZip</span><span class=p>(</span>
  <span class=n>UnstructuredData</span> <span class=n>unstructured</span><span class=p>,</span>
  <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>InputStream</span><span class=o>&gt;</span> <span class=n>filesToArchive</span>
<span class=p>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
  <span class=c1>// A stream variant is also available</span>
  <span class=k>try</span> <span class=p>(</span><span class=n>ZipArchiveOutputFile</span> <span class=n>zip</span> <span class=o>=</span> <span class=n>unstructured</span><span class=p>.</span><span class=na>newZipOutputFile</span><span class=p>(</span><span class=s>&quot;test.zip&quot;</span><span class=p>))</span> <span class=p>{</span>
    <span class=k>for</span> <span class=p>(</span><span class=n>Map</span><span class=p>.</span><span class=na>Entry</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>InputStream</span><span class=o>&gt;</span> <span class=n>dataToArchive</span> <span class=p>:</span> <span class=n>filesToArchive</span><span class=p>.</span><span class=na>entrySet</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>String</span> <span class=n>entryName</span> <span class=o>=</span> <span class=n>dataToArchive</span><span class=p>.</span><span class=na>getKey</span><span class=p>();</span>
      <span class=n>InputStream</span> <span class=n>entryContent</span> <span class=o>=</span> <span class=n>dataToArchive</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
      <span class=n>ZipArchiveEntry</span> <span class=n>zipEntry</span> <span class=o>=</span> <span class=n>zip</span><span class=p>.</span><span class=na>createArchiveEntry</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=n>entryName</span><span class=p>);</span>
      <span class=n>zip</span><span class=p>.</span><span class=na>addEntry</span><span class=p>(</span><span class=n>zipEntry</span><span class=p>,</span> <span class=n>entryContent</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_2_2 name=__tabbed_2 type=radio><label for=__tabbed_2_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span>
<span class=k>import</span> <span class=nn>java.io.IOException</span>
<span class=k>import</span> <span class=nn>java.io.InputStream</span>

<span class=n>@Throws</span><span class=p>(</span><span class=n>IOException</span><span class=o>::</span><span class=k>class</span><span class=p>)</span>
<span class=k>fun</span> <span class=nf>createZip</span><span class=p>(</span>
  <span class=n>unstructured</span><span class=p>:</span> <span class=n>UnstructuredData</span><span class=p>,</span>
  <span class=n>filesToArchive</span><span class=p>:</span> <span class=n>Map</span><span class=p>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>InputStream</span><span class=p>&gt;</span>
<span class=p>)</span> <span class=p>{</span>
  <span class=c1>// A stream variant is also available</span>
  <span class=n>unstructured</span><span class=p>.</span><span class=n>newZipOutputFile</span><span class=p>(</span><span class=s>&quot;test.zip&quot;</span><span class=p>).</span><span class=n>use</span> <span class=p>{</span> <span class=n>zip</span> <span class=p>-&gt;</span>
    <span class=k>for</span> <span class=p>((</span><span class=n>entryName</span><span class=p>,</span> <span class=n>entryContent</span><span class=p>)</span> <span class=k>in</span> <span class=n>filesToArchive</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>val</span> <span class=py>zipEntry</span> <span class=p>=</span> <span class=n>zip</span><span class=p>.</span><span class=n>createArchiveEntry</span><span class=p>(</span><span class=k>null</span><span class=p>,</span> <span class=n>entryName</span><span class=p>)</span>
      <span class=n>zip</span><span class=p>.</span><span class=n>addEntry</span><span class=p>(</span><span class=n>zipEntry</span><span class=p>,</span> <span class=n>entryContent</span><span class=p>)</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <h3 id=configuring-encryption>Configuring encryption<a class=headerlink href=#configuring-encryption title="Permanent link">&para;</a></h3> <p>By default, the SDK chooses an encryption method that provides strong security and is well suited for most applications. It may be desirable to change the encryption method (also called the encryption algorithm) used to create new ZIP entries. The SDK provides a simple of way setting the most common and useful encryption methods.</p> <div class=tabbed-set data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.ArchiveEntry</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>configureEncryptionMethod</span><span class=p>(</span><span class=n>ZipArchiveOutput</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Configure encryption to use AE2 (for compatibility with other ZIP programs)</span>
  <span class=n>zip</span><span class=p>.</span><span class=na>setCryptAlgorithm</span><span class=p>(</span><span class=n>ArchiveEntry</span><span class=p>.</span><span class=na>CRYPT_AE2</span><span class=p>);</span>
  <span class=c1>// Configure encryption to use AES-256</span>
  <span class=n>zip</span><span class=p>.</span><span class=na>setCryptAlgorithm</span><span class=p>(</span><span class=n>ArchiveEntry</span><span class=p>.</span><span class=na>CRYPT_AES_256</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_3_2 name=__tabbed_3 type=radio><label for=__tabbed_3_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.archive.ArchiveEntry</span>
<span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span>

<span class=k>fun</span> <span class=nf>configureEncryptionMethod</span><span class=p>(</span><span class=n>zip</span><span class=p>:</span> <span class=n>ZipArchiveOutput</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Configure encryption to use AE2 (for compatibility with other ZIP programs)</span>
  <span class=n>zip</span><span class=p>.</span><span class=n>cryptAlgorithm</span> <span class=p>=</span> <span class=n>ArchiveEntry</span><span class=p>.</span><span class=n>CRYPT_AE2</span><span class=p>.</span><span class=n>toInt</span><span class=p>()</span>
  <span class=c1>// Configure encryption to use AES-256</span>
  <span class=n>zip</span><span class=p>.</span><span class=n>cryptAlgorithm</span> <span class=p>=</span> <span class=n>ArchiveEntry</span><span class=p>.</span><span class=n>CRYPT_AES_256</span><span class=p>.</span><span class=n>toInt</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <h3 id=configuring-compression>Configuring compression<a class=headerlink href=#configuring-compression title="Permanent link">&para;</a></h3> <p>By default, the SDK chooses compression setting that balances speed with compressed size. However, it is possible to change the compression method. One might use a different compression algorithm , such as deflate, store, and LZMA, or specify a different compression level (higher for smaller ZIPs, lower for faster processing) as the application requires.</p> <div class=tabbed-set data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><label for=__tabbed_4_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.ArchiveEntry</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>compressionMethod</span><span class=p>(</span><span class=n>ZipArchiveOutput</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Configure compression to use the deflate algorithm at level 6</span>
  <span class=n>zip</span><span class=p>.</span><span class=na>setCompressMethod</span><span class=p>(</span><span class=n>ArchiveEntry</span><span class=p>.</span><span class=na>COMPRESS_METHOD_DEFLATE</span><span class=p>,</span> <span class=mi>6</span><span class=p>);</span>
  <span class=c1>// Configure compression to use the store algorithm (no compression)</span>
  <span class=n>zip</span><span class=p>.</span><span class=na>setCompressMethod</span><span class=p>(</span><span class=n>ArchiveEntry</span><span class=p>.</span><span class=na>COMPRESS_METHOD_STORE</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_4_2 name=__tabbed_4 type=radio><label for=__tabbed_4_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.archive.ArchiveEntry</span>
<span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span>

<span class=k>fun</span> <span class=nf>compressionMethod</span><span class=p>(</span><span class=n>zip</span><span class=p>:</span> <span class=n>ZipArchiveOutput</span><span class=p>)</span> <span class=p>{</span>
  <span class=c1>// Configure compression to use the deflate algorithm at level 6</span>
  <span class=n>zip</span><span class=p>.</span><span class=n>setCompressMethod</span><span class=p>(</span><span class=n>ArchiveEntry</span><span class=p>.</span><span class=n>COMPRESS_METHOD_DEFLATE</span><span class=p>,</span> <span class=m>6</span><span class=p>)</span>
  <span class=c1>// Configure compression to use the store algorithm (no compression)</span>
  <span class=n>zip</span><span class=p>.</span><span class=n>compressMethod</span> <span class=p>=</span> <span class=n>ArchiveEntry</span><span class=p>.</span><span class=n>COMPRESS_METHOD_STORE</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <h2 id=encryption>Encryption<a class=headerlink href=#encryption title="Permanent link">&para;</a></h2> <p>Encryption using both passwords and Smartkeys is straightforward. See the <a href=/keyManagement/#create-smartkey>Key Management docs</a> for details on how to obtain a Smartkey.</p> <div class=tabbed-set data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><label for=__tabbed_5_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.keymanagement.smartkeys.Smartkey</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClientException</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.EncryptionSpec</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>contingencyGroupWithSmartkey</span><span class=p>(</span>
  <span class=n>UnstructuredData</span> <span class=n>unstructured</span><span class=p>,</span>
  <span class=n>Smartkey</span> <span class=n>smartkey</span><span class=p>,</span>
  <span class=c1>// Create the ZIP as you normally would</span>
  <span class=n>ZipArchiveOutput</span> <span class=n>zip</span>
<span class=p>)</span> <span class=kd>throws</span> <span class=n>MetaClientException</span> <span class=p>{</span>
  <span class=n>EncryptionSpec</span> <span class=n>spec</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EncryptionSpec</span><span class=p>();</span>
  <span class=c1>// Optionally add a password here as well</span>
  <span class=n>spec</span><span class=p>.</span><span class=na>smartkey</span> <span class=o>=</span> <span class=n>smartkey</span><span class=p>;</span>

  <span class=n>unstructured</span><span class=p>.</span><span class=na>encrypt</span><span class=p>(</span><span class=n>zip</span><span class=p>,</span> <span class=n>spec</span><span class=p>);</span>

  <span class=c1>// Proceed to add files to the ZIP as you normally would</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_5_2 name=__tabbed_5 type=radio><label for=__tabbed_5_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.keymanagement.smartkeys.Smartkey</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClientException</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.EncryptionSpec</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span>

<span class=n>@Throws</span><span class=p>(</span><span class=n>MetaClientException</span><span class=o>::</span><span class=k>class</span><span class=p>)</span>
<span class=k>fun</span> <span class=nf>contingencyGroupWithSmartkey</span><span class=p>(</span>
  <span class=n>unstructured</span><span class=p>:</span> <span class=n>UnstructuredData</span><span class=p>,</span>
  <span class=n>smartkey</span><span class=p>:</span> <span class=n>Smartkey</span><span class=p>,</span>
  <span class=c1>// Create the ZIP as you normally would</span>
  <span class=n>zip</span><span class=p>:</span> <span class=n>ZipArchiveOutput</span>
<span class=p>)</span> <span class=p>{</span>
  <span class=k>val</span> <span class=py>spec</span> <span class=p>=</span> <span class=n>EncryptionSpec</span><span class=p>()</span>
  <span class=c1>// Optionally add a password here as well</span>
  <span class=n>spec</span><span class=p>.</span><span class=n>smartkey</span> <span class=p>=</span> <span class=n>smartkey</span><span class=p>;</span>

  <span class=n>unstructured</span><span class=p>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>zip</span><span class=p>,</span> <span class=n>spec</span><span class=p>)</span>

  <span class=c1>// Proceed to add files to the ZIP as you normally would</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <div class="admonition important"> <p class=admonition-title>Important</p> <p>In order for Smartcrypt Contingency Groups to apply, you must run your application as Smartcrypt.</p> </div> <h3 id=contingency-group-without-smartkey>Contingency group without Smartkey<a class=headerlink href=#contingency-group-without-smartkey title="Permanent link">&para;</a></h3> <p>The recommended way to gain access to the Contingency Group functionality of Smartcrypt is to use Smartkeys when encrypting. However, there may be some scenarios in which using a Smartkey is not an option. For these scenarios, we also provide the option of skipping the Smartkey, but still gaining the benefits of Contingency Groups.</p> <div class=tabbed-set data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><label for=__tabbed_6_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClientException</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.EncryptionSpec</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>contingencyGroupWithoutSmartkey</span><span class=p>(</span>
  <span class=n>UnstructuredData</span> <span class=n>unstructured</span><span class=p>,</span>
  <span class=c1>// Create the ZIP as you normally would</span>
  <span class=n>ZipArchiveOutput</span> <span class=n>zip</span>
<span class=p>)</span> <span class=kd>throws</span> <span class=n>MetaClientException</span> <span class=p>{</span>
  <span class=n>EncryptionSpec</span> <span class=n>spec</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EncryptionSpec</span><span class=p>();</span>
  <span class=c1>// The password must be provided if not specifying a Smartkey to gain contingency benefits</span>
  <span class=n>spec</span><span class=p>.</span><span class=na>password</span> <span class=o>=</span> <span class=s>&quot;secret secret&quot;</span><span class=p>;</span>

  <span class=n>unstructured</span><span class=p>.</span><span class=na>encrypt</span><span class=p>(</span><span class=n>zip</span><span class=p>,</span> <span class=n>spec</span><span class=p>);</span>

  <span class=c1>// Proceed to add files to the ZIP as you normally would</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_6_2 name=__tabbed_6 type=radio><label for=__tabbed_6_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveOutput</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.metaclient.MetaClientException</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.EncryptionSpec</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span>

<span class=n>@Throws</span><span class=p>(</span><span class=n>MetaClientException</span><span class=o>::</span><span class=k>class</span><span class=p>)</span>
<span class=k>fun</span> <span class=nf>contingencyGroupWithoutSmartkey</span><span class=p>(</span>
  <span class=n>unstructured</span><span class=p>:</span> <span class=n>UnstructuredData</span><span class=p>,</span>
  <span class=c1>// Create the ZIP as you normally would</span>
  <span class=n>zip</span><span class=p>:</span> <span class=n>ZipArchiveOutput</span>
<span class=p>)</span> <span class=p>{</span>
  <span class=k>val</span> <span class=py>spec</span> <span class=p>=</span> <span class=n>EncryptionSpec</span><span class=p>()</span>
  <span class=c1>// The password must be provided if not specifying a Smartkey to gain contingency benefits</span>
  <span class=n>spec</span><span class=p>.</span><span class=n>password</span> <span class=p>=</span> <span class=s>&quot;secret secret&quot;</span><span class=p>;</span>

  <span class=n>unstructured</span><span class=p>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>zip</span><span class=p>,</span> <span class=n>spec</span><span class=p>)</span>

  <span class=c1>// Proceed to add files to the ZIP as you normally would</span>
<span class=p>}</span>
</code></pre></div> </div> </div> <div class="admonition important"> <p class=admonition-title>Important</p> <p>In order for Smartcrypt Contingency Groups to apply, you must run your application as Smartcrypt. See the [MetaClient Policy] docs for more details.</p> </div> <h2 id=decryption>Decryption<a class=headerlink href=#decryption title="Permanent link">&para;</a></h2> <p>Once you have an <code>UnstructuredData</code> instance, decrypting ZIP archives encrypted using a Smartkey is easy! If you do not have access to the Smartkey, but are part of the Contingency Group, this snippet will also grant you access to the files.</p> <div class=tabbed-set data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><label for=__tabbed_7_1>Java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveEntry</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.archive.zip.ZipFile</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.File</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.FileOutputStream</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.IOException</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.InputStream</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.OutputStream</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>UnstructuredData</span> <span class=n>unstructuredData</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
  <span class=k>try</span> <span class=p>(</span><span class=n>ZipFile</span> <span class=n>encrypted</span> <span class=o>=</span> <span class=n>unstructuredData</span><span class=p>.</span><span class=na>newZipFile</span><span class=p>(</span><span class=k>new</span> <span class=n>File</span><span class=p>(</span><span class=s>&quot;encrypted.zip&quot;</span><span class=p>)))</span> <span class=p>{</span>
    <span class=n>ZipArchiveEntry</span> <span class=n>entry</span> <span class=o>=</span> <span class=n>encrypted</span><span class=p>.</span><span class=na>getEntry</span><span class=p>(</span><span class=s>&quot;example.txt&quot;</span><span class=p>);</span>
    <span class=k>try</span> <span class=p>(</span><span class=n>OutputStream</span> <span class=n>fileStream</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;example.txt&quot;</span><span class=p>))</span> <span class=p>{</span>
      <span class=k>try</span> <span class=p>(</span><span class=n>InputStream</span> <span class=n>decryptStream</span> <span class=o>=</span> <span class=n>encrypted</span><span class=p>.</span><span class=na>getInputStream</span><span class=p>(</span><span class=n>entry</span><span class=p>))</span> <span class=p>{</span>
        <span class=n>decryptStream</span><span class=p>.</span><span class=na>transferTo</span><span class=p>(</span><span class=n>fileStream</span><span class=p>);</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <input id=__tabbed_7_2 name=__tabbed_7 type=radio><label for=__tabbed_7_2>Kotlin</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipArchiveEntry</span>
<span class=k>import</span> <span class=nn>com.pkware.archive.zip.ZipFile</span>
<span class=k>import</span> <span class=nn>com.pkware.smartcrypt.unstructured.UnstructuredData</span>
<span class=k>import</span> <span class=nn>java.io.File</span>
<span class=k>import</span> <span class=nn>java.io.FileOutputStream</span>
<span class=k>import</span> <span class=nn>java.io.IOException</span>
<span class=k>import</span> <span class=nn>java.io.InputStream</span>
<span class=k>import</span> <span class=nn>java.io.OutputStream</span>

<span class=n>@Throws</span><span class=p>(</span><span class=n>IOException</span><span class=o>::</span><span class=k>class</span><span class=p>)</span>
<span class=k>fun</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>unstructuredData</span><span class=p>:</span> <span class=n>UnstructuredData</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>unstructuredData</span><span class=p>.</span><span class=n>newZipFile</span><span class=p>(</span><span class=n>File</span><span class=p>(</span><span class=s>&quot;encrypted.zip&quot;</span><span class=p>)).</span><span class=n>use</span> <span class=p>{</span> <span class=n>encrypted</span> <span class=p>-&gt;</span>
    <span class=k>val</span> <span class=py>entry</span> <span class=p>=</span> <span class=n>encrypted</span><span class=p>.</span><span class=n>getEntry</span><span class=p>(</span><span class=s>&quot;example.txt&quot;</span><span class=p>)</span>
    <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;example.txt&quot;</span><span class=p>).</span><span class=n>use</span> <span class=p>{</span> <span class=n>fileStream</span> <span class=p>-&gt;</span>
      <span class=n>encrypted</span><span class=p>.</span><span class=n>getInputStream</span><span class=p>(</span><span class=n>entry</span><span class=p>).</span><span class=n>use</span> <span class=p>{</span> <span class=n>decryptStream</span> <span class=p>-&gt;</span>
        <span class=n>decryptStream</span><span class=p>.</span><span class=n>transferTo</span><span class=p>(</span><span class=n>fileStream</span><span class=p>);</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../troubleshooting/ title=Troubleshooting class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Troubleshooting </div> </div> </a> <a href=installing/ title=Installing class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Installing </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 PKWARE, Inc. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.d710d30a.min.js></script> <script src=../assets/javascripts/bundle.7f4f3c92.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9b3611bd.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>